\chapter{Architecture and Implementation}
\label{chap:architecture_and_implementation}

In this chapter we have the implementation and the architecture of \ac{sems}, showing the main system modules, design decisions,
problems and impediments and their solutions and the design approaches taken during the implementation of \ac{sems}.

\section{Framework Selection}
\label{sec:framework_selection}
Before starting the implementation of the project, we examined some frameworks, most of them are \ac{js} ( NodeJS ) based;
this is due to the current state of \ac{js} community where one can find a well structured and maintained projects and modules.

\newParagraph
We started to do a quick tests and comparisons between Express.js, Hapi.js, Sails.js and meteor.js; the main goal was to have a stable
and functional system in the shortest period possible, that was required because \ac{sems} was planned to be used in the same year, forcing
us to have a production-ready application within 2 weeks of the project start.

\newParagraph
With that in mind, we chose meteor.js as our main framework, supported with blaze templating engine for the views, and mongoDB as the
database system, allowing us to push forward and focus on system design quickly while maintaining a stable application and framework
to be ready for production releases.

\section{Deployment}
\label{sec:deployment}
We had tested 2 deployment techniques during the implementation of the project, the main goal was to have smooth deployments frequently with
the new features, while maintaining the stability of the system with minimum downtime and quick recovery in case of crashes or bugs.

\newParagraph
First trail was to have a docker container hosting our meteor application on the server, the deployment was easy to be done with a tool
called mupx~\cite{mupx}, However, having a docker container with meteor application was not the best choice for us to recover from downtimes,
that is beacuse we are dealing with local storage on our server as we do not use any external storage server, making it hard to migrate between
different deployments while preserving our local filesystem without problems.

\section{Analytics}
\label{sec:analytics}

\ac{sems} uses MixPanel\texttrademark{} as the main analytic and tracking tool, using analytics.js~\cite{analytics_js} MixPanel\texttrademark{} is
integrated in the system, allowing tracking page views, feature usage and custom events, this improved the evaluation of changes applied on the
system by measuring user interaction and involvement with new features.

\newParagraph
The deployment finally was done using Meteor's build tool, that allows bundling the application and producing an application that is ready
to run in a NodeJS environment, this allowed us to easily build and deploy our application quickly, specially when hotfixes are applied,
and also it helped us to recover from problems that can affect our server filesystem by easily backing up the directories and files frequently.


\section{System Modules}
\label{sec:modules}

In this section, we discover the main modules of \ac{sems}, with implementation notes on specific parts.
\includefig{0.85}{sems-landing-page.png}{\ac{sems} Landing Page}{fig:sems-landing-page}

\subsection{Users}
\label{sub:users}
Users module is the very first module that was constructed on the system, enabling students and instructors to register with their
university emails, and providing basic information that is needed throughout the course, this includes the university ID, the study group
and more contact information for reachability and performance tracking. To ensure that the students are registered with their correct email
address, most system services are locked until the user verifies his email address. A password reset request can be initiated by the user
in case of password loss to reset his password.
\includefig{0.85}{sems-registration.png}{\ac{sems} Registration Form}{fig:sems-registration}

\newParagraph
Each user can access his profile page, edit his basic information and add an avatar to his profile. To have a better connection
between students and instructors, everyone can see the public profile of other users if he is logged in on the system, the user
can determine what to show on his public profile through the profile edit page, also if the user is enrolled in a team, the team
is linked on his public profile automatically.
\includefig{0.85}{sems-public-profile.png}{\ac{sems} user profile}{fig:sems-public-profile}

\newParagraph
\ac{sems} have different roles for users, which is modifiable by administrators, those roles are :

\begin{description}[align=left]
\item [student] The default role upon user creation, a student can be added to teams, and can only create content in discussion section,
student does not have any administrative abilities.
\item [scrum master] A student that have authority over his team, he is allowed to create, add, remove members and modify data of his team.
\item [\ac{jta}] JTAs have access to teams, all announcements and milestones and they can modify and delete questions and answers on discussion section
\item [\ac{ta}] TAs have access to all of the above (Except Team Creation) and they have access to modify schedule and announcements.
\item [Instructor] Instructors have access to all of the above (Except Team Creation) and they can modify and create milestones.
\item [Admin] Admin can modify everything on the system, including removing users and modifying member roles.
\end{description}

\subsection{Course Schedule}
\label{sub:schedule}
\includefig{0.85}{sems-schedule.png}{\ac{sems} Schedule View}{fig:sems-schedule}
The schedule is used for course material posting, it is the only public main service that is accessible without registration in order to make
it easier for students to access it. The Schedule module lists all the course material, including lectures, assignments and code snippets. The schedule
is influenced by the \ac{met} portal course schedule, it displays the materials by the week set in course schedule, also it allows the user
to filter by the material type. The upload problem faced on the \ac{met} portal is solved by allowing the instructor to choose between uploading
the materials or just linking to an outside source, allowing the instructor to have more flexibility to handle the material posted on the system.
Instructors can delete posted materials or edit it on the schedule at any time, changing its details and even changing the type of the material from
uploaded to a direct link and vice-versa.
\includefig{0.85}{sems-schedule-edit.png}{\ac{sems} Schedule Edit}{fig:sems-schedule-edit}

\subsection{Teams}
\label{sub:teams}
\ac{se} is a team oriented course, course layout is structured upon teams, that is why team creation, modification and traversing is an
important module of the system. Team module have multiple views, there is an instructor, scrum master, member and non member view, each
allows access to specific parts of the team based on the role, in the following sections we have a look on the different features and views
in Teams.

\subsubsection{Team Creation}
\label{subs:team-creation}
This view is only accessible by the scrum master if he/she did not create any teams yet, allowing the scrum master to choose the airline company
to work with and choose a name for his team, the scrum master is also asked to provide the GitHub repository of the team that will hold
their codebase.
\includefig{0.4}{sems-team-creation.png}{\ac{sems} Team Creation View}{fig:sems-team-creation}

\subsubsection{Team browse}
\label{subs:team-browse}
When a user navigate through teams tab, all teams are listed in this view, with some information about each team like their deployed application
IP address, their ionic ID \quotes{discussed in REFERENCE THE SECTION} and the number of members in the team, the user can click on a team to
be directed to that team page, there are 3 cases that could happen :
\begin{itemize}
  \item The user is a not a member of the team : The team page will only show the team name, company and the members in the team as in
  figure \ref{fig:sems-team-about}, all other team information is locked and not accessible for that user.
  \item The user is a member of the team : The team page will show the team information, and additionally a side bar is shown
  giving access to milestones, announcements and grades of that team \quotes{discussed in section REFERENCE HERE}.
  \item The user is a member and the scrum master of the team or the user have administrative role : The previous view is shown with an extra
  option to access the team settings panel which is shown in \ref{subs:team-settings}.
\end{itemize}
\includefig{0.65}{sems-team-about.png}{\ac{sems} Team Information}{fig:sems-team-about}
\includefig{0.65}{sems-edit-team.png}{\ac{sems} Team Editing Panel}{fig:sems-edit-team}

\subsubsection{Team Settings}
\label{subs:team-settings}
After creating a team, the team Scrum Master or System Administrators can access the team edit panel, as shown in figure \ref{fig:sems-edit-team}
this panel allows the user
to change the team data, add or remove members. The \quotes{Add Members} dropdown displays all users on the system with a \quotes{student} role
who are not enrolled in any team yet. Once a member is added to the team, an Email is sent informing that user with his team name
and that he joined the team successfully, and a badge is added on his public profile linking to the team he had joined, also, his name
is not available to be chosen again in other teams.
